<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Enable responsive scaling on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Baby Land</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
  <style>
    /* CSS Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; }
    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #ff9a9e, #a1c4fd);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      overflow-x: hidden;
    }
    header {
      margin-bottom: 20px;
      text-align: center;
      animation: fadeIn 1s ease-in;
      width: 100%;
    }
    header h1 {
      font-size: 2.5em;
      color: #fff;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      margin-bottom: 10px;
    }
    /* Search Bar Styles */
    .search-input {
      width: 90%;
      max-width: 300px;
      padding: 10px;
      margin-bottom: 20px;
      border: 1px solid #aaa;
      border-radius: 6px;
      font-size: 1em;
    }
    /* CSS Grid Container for Product Boxes */
    .product-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      width: 100%;
      max-width: 1200px;
      margin-bottom: 20px;
      animation: fadeIn 1s ease-in;
    }
    /* Product Card Styles */
    .product-card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px;
      font-size: 0.9em;
      font-weight: bold;
      transition: transform 0.2s, box-shadow 0.2s;
      position: relative;
    }
    .product-card:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .product-card.selected {
      border: 2px solid #ff4081;
    }
    /* Styling for quantity input */
    .qty-input {
      width: 50px;
      margin: 5px 0;
      padding: 4px;
      border-radius: 4px;
      border: 1px solid #aaa;
      text-align: center;
      font-size: 0.9em;
    }
    /* Styling for remove button */
    .remove-btn {
      background: #ff4081;
      border: none;
      padding: 3px 8px;
      border-radius: 6px;
      font-size: 0.8em;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
      margin-bottom: 4px;
    }
    .remove-btn:hover {
      background: #e0356a;
    }
    /* Order Summary Section */
    .summary-container {
      display: none;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 1s ease-in;
      width: 100%;
    }
    table {
      border-collapse: collapse;
      margin-bottom: 20px;
      width: 90%;
      max-width: 500px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 8px;
      text-align: center;
      font-size: 0.9em;
    }
    th {
      background: #a1c4fd;
      color: #fff;
    }
    input[type="text"],
    input[type="tel"] {
      width: 90%;
      max-width: 300px;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #aaa;
      border-radius: 6px;
      font-size: 1em;
    }
    .btn {
      background: linear-gradient(135deg, #ff9a9e, #a1c4fd);
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 1em;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin: 10px;
    }
    .btn:hover {
      background: linear-gradient(135deg, #a1c4fd, #ff9a9e);
    }
    /* Thank You Section */
    .thankyou-section {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 70vh;
      text-align: center;
      animation: fadeIn 1s ease-in;
      padding: 20px;
      width: 90%;
    }
    .thankyou-section h1 {
      font-size: 2.5em;
      color: #fff;
      margin-bottom: 20px;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    }
    .thankyou-section p {
      font-size: 1.1em;
      color: #fff;
      margin-bottom: 10px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    /* Media Query: For very small screens - force single-column layout for product cards */
    @media (max-width: 600px) {
      .product-container {
        grid-template-columns: 1fr;
      }
      header h1 {
        font-size: 2em;
      }
      .btn {
        padding: 8px 16px;
        font-size: 0.9em;
      }
      .search-input {
        max-width: 260px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Baby Land</h1>
  </header>
  
  <!-- Product Selection Section -->
  <section id="selection-section">
    <!-- Search bar -->
    <input type="text" id="searchBar" class="search-input" placeholder="Search Product Code">
    <div class="product-container" id="productContainer">
      <!-- 200 product cards will be generated here dynamically -->
    </div>
    <button class="btn" id="goSummary">Review Order</button>
  </section>
  
  <!-- Order Summary Section -->
  <section id="summary-section" class="summary-container">
    <h2 style="color: #fff; margin-bottom: 20px;">Order Summary</h2>
    <table id="orderTable">
      <thead>
        <tr>
          <th>Product Code</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody>
        <!-- Order rows will be inserted here -->
      </tbody>
    </table>
    <!-- Order Form -->
    <form id="orderForm" action="https://script.google.com/macros/s/AKfycbzhOT9zEqhZnwTef43yTdKEyF75hOId535P2oPmm6vwi2q1pJNFvzIxVUYDX0iSxBxrqg/exec" method="POST">
      <input type="hidden" name="orderDetails" id="orderDetails">
      <!-- Personal Information Fields -->
      <input type="text" name="name" placeholder="Your Name" required>
      <!-- New Store Name Field -->
      <input type="text" name="storeName" placeholder="Store Name" required>
      <input type="tel" name="phone" placeholder="Phone Number" required>
      <input type="text" name="location" placeholder="Location" required>
      <button type="submit" class="btn">Submit Order</button>
    </form>
    <button class="btn" id="backToSelection" style="background: rgba(0,0,0,0.4);">Back to Selection</button>
  </section>
  
  <!-- Thank You Section -->
  <section id="thankyou-section" class="thankyou-section">
    <h1>Thank You!</h1>
    <p>Your order has been successfully submitted.</p>
    <p>We appreciate your business at Baby Land.</p>
    <button class="btn" id="newOrderBtn">Place New Order</button>
  </section>
  
  <script>
    // Generate product cards (codes 1 to 200)
    const products = [];
    for (let i = 1; i <= 200; i++) {
      products.push({ code: i.toString() });
    }
  
    // Order object to store product codes and quantities
    let order = {};
    const productContainer = document.getElementById('productContainer');
  
    // Function to update the order object and adjust card visuals
    function updateOrder(productCode, quantity, card) {
      if (quantity > 0) {
        order[productCode] = quantity;
        card.classList.add('selected');
      } else {
        delete order[productCode];
        card.classList.remove('selected');
      }
    }
  
    // Dynamically create product cards
    function loadProducts() {
      products.forEach(product => {
        const card = document.createElement('div');
        card.classList.add('product-card');
        card.dataset.code = product.code;
  
        // Create and display product code
        const codeDisplay = document.createElement('div');
        codeDisplay.textContent = "Code " + product.code;
        codeDisplay.style.fontWeight = 'bold';
        codeDisplay.style.fontSize = '1.2em';
        card.appendChild(codeDisplay);
  
        // Create quantity input field
        const qtyInput = document.createElement('input');
        qtyInput.type = 'number';
        qtyInput.min = '0';
        qtyInput.value = '0';
        qtyInput.classList.add('qty-input');
        card.appendChild(qtyInput);
  
        // Create Remove button
        const removeBtn = document.createElement('button');
        removeBtn.textContent = 'Remove';
        removeBtn.classList.add('remove-btn');
        card.appendChild(removeBtn);
  
        // Update order when input changes
        qtyInput.addEventListener('change', () => {
          const quantity = parseInt(qtyInput.value) || 0;
          updateOrder(product.code, quantity, card);
        });
  
        // Remove button resets the input field
        removeBtn.addEventListener('click', () => {
          qtyInput.value = '0';
          updateOrder(product.code, 0, card);
        });
  
        productContainer.appendChild(card);
      });
    }
    loadProducts();
  
    // Search bar functionality: scroll to and highlight matching product card
    const searchBar = document.getElementById('searchBar');
    searchBar.addEventListener('keyup', (e) => {
      const query = e.target.value.trim();
      if (query) {
        const foundCard = productContainer.querySelector(`[data-code="${query}"]`);
        if (foundCard) {
          foundCard.scrollIntoView({ behavior: "smooth", block: "center" });
          foundCard.style.border = "3px solid #FFD700";
          setTimeout(() => {
            foundCard.style.border = "";
          }, 2000);
        }
      }
    });
  
    // Ensure all inputs update the order object before transitioning to summary view
    function updateAllInputs() {
      document.querySelectorAll('.qty-input').forEach(input => {
        const card = input.parentElement;
        const code = card.dataset.code;
        const quantity = parseInt(input.value) || 0;
        updateOrder(code, quantity, card);
      });
    }
  
    // Transition to order summary view
    const goSummaryBtn = document.getElementById('goSummary');
    const selectionSection = document.getElementById('selection-section');
    const summarySection = document.getElementById('summary-section');
    const orderTableBody = document.getElementById('orderTable').querySelector('tbody');
    const orderDetailsInput = document.getElementById('orderDetails');
  
    goSummaryBtn.addEventListener('click', () => {
      updateAllInputs();
      orderTableBody.innerHTML = '';
      for (const code in order) {
        if (order.hasOwnProperty(code)) {
          const row = document.createElement('tr');
          const codeCell = document.createElement('td');
          codeCell.textContent = "Code " + code;
          const qtyCell = document.createElement('td');
          qtyCell.textContent = order[code];
          row.appendChild(codeCell);
          row.appendChild(qtyCell);
          orderTableBody.appendChild(row);
        }
      }
      orderDetailsInput.value = JSON.stringify(order);
      selectionSection.style.display = 'none';
      summarySection.style.display = 'flex';
    });
  
    // Allow return to product selection view
    const backBtn = document.getElementById('backToSelection');
    backBtn.addEventListener('click', () => {
      summarySection.style.display = 'none';
      selectionSection.style.display = 'block';
    });
  
    // Intercept form submission using fetch
    const orderForm = document.getElementById('orderForm');
    orderForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(orderForm);
      fetch(orderForm.action, {
         method: 'POST',
         body: formData
      })
      .then(response => response.text())
      .then(data => {
         summarySection.style.display = 'none';
         document.getElementById('thankyou-section').style.display = 'flex';
      })
      .catch(error => {
         console.error("Error submitting form:", error);
         alert("Error submitting your order. Please try again.");
      });
    });
  
    // New order button: reload the page
    const newOrderBtn = document.getElementById('newOrderBtn');
    newOrderBtn.addEventListener('click', () => {
      location.reload();
    });
  </script>
</body>
</html>
